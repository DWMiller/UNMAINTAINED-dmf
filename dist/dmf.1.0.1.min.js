var CORE=function(){"use strict";var a={},b=!1;return{modules:a,config:{},data:{},events:{},activate:function(a){this.startModule("system-controller"),"undefined"!=typeof a&&this.startModule(a)},debug:function(a){b="undefined"!==a?a?!0:!1:!b},extendConfig:function(a){$.extend(!0,this.config,a)},createModule:function(b,c){var d;"string"==typeof b&&"function"==typeof c?(d=c(this),d.initialize&&"function"==typeof d.initialize&&d.destroy&&"function"==typeof d.destroy?(d=null,a[b]={create:c,instance:null},this.log(1,"Module '"+b+"' Registration : SUCCESS")):this.log(2,"Module '"+b+"' Registration : FAILED : instance has no initialize or destroy functions")):this.log(2,"Module '"+b+"' Registration : FAILED : one or more arguments are of incorrect type")},getModule:function(b){var c=a[b];return c?c.create(this):!1},startModule:function(b){var c=a[b];c&&(c.instance=this.getModule(b),c.instance.initialize(this.Sandbox),this.log(1,"Start Module '"+b+"': SUCCESS"))},startAllModules:function(){var b;for(b in a)a.hasOwnProperty(b)&&this.startModule(b)},stopModule:function(b){var c;(c=a[b])&&c.instance?(c.instance.destroy(),c.instance=null,this.log(1,"Stop Module '"+b+"': SUCCESS")):this.log(2,"Stop Module '"+b+"': FAILED : module does not exist or has not been started")},stopAllModules:function(){var b;for(b in a)a.hasOwnProperty(b)&&this.stopModule(b)},registerEvents:function(a,b){if(this.is_obj(a)&&b)for(var c in a)this.events[c]||(this.events[c]={}),this.events[c][b]=a[c];else this.log(1,"Error registering events for: "+b)},triggerEvent:function(a){var b=this.events[a.type];if(b)for(var c in b)b[c](a.data)},removeEvents:function(a,b){a.forEach(function(a){delete CORE.events[a][b]})},log:function(a,c){if(b){this.is_arr(c)||(c=[c]);for(var d=0;d<c.length;d++)console[1===a?"log":2===a?"warn":"error"](JSON.stringigy(c[d],null,4))}},changeLanguage:function(a){var b={type:"language-change",data:{language:a}};this.triggerEvent(b)},is_arr:function(a){return jQuery.isArray(a)},is_obj:function(a){return jQuery.isPlainObject(a)},extend:function(a,b){jQuery.extend(!0,a,b)}}}();CORE.Sandbox={create:function(a,b,c){var d=document.getElementById(c)||document.getElementById("main-container");return{self:function(){return d},find:function(b){return a.dom.find(b,d)},addEvent:function(b,c,d){a.dom.bind(b,c,d)},removeEvent:function(b,c,d){a.dom.unbind(b,c,d)},notify:function(b){a.is_obj(b)&&b.type&&a.triggerEvent(b)},listen:function(c){a.registerEvents(c,b)},ignore:function(c){if(!a.is_arr(c)){var d=c;c=[d]}a.removeEvents(c,b)},hide:function(b){"undefined"==typeof b&&(b=d),a.dom.removeClass(b,"visible"),a.dom.addClass(b,"hidden")},show:function(b){"undefined"==typeof b&&(b=d),a.dom.addClass(b,"visible"),a.dom.removeClass(b,"hidden")}}}},CORE.extendConfig({"system-server":{endpoint:"http://127.0.0.1:8080/"},"system-localize":{default_language:"en",path:"js/localization/",ext:".lang.json"}}),CORE.createModule("system-controller",function(a){"use strict";function b(b){f=b.create(a,g.id),a.startModule("system-server"),a.startModule("system-data"),a.startModule("system-localize"),d()}function c(){e(),a.stopModule("system-server"),a.stopModule("system-data"),a.stopModule("system-localize")}function d(){f.listen(h)}function e(){f.ignore(Object.keys(h))}var f,g={id:"system-controller"},h={};return{properties:g,initialize:b,destroy:c}}),CORE.createModule("system-data",function(a){"use strict";function b(b){h=b.create(a,i.id),d()}function c(){e()}function d(){h.listen(j)}function e(){h.ignore(Object.keys(j))}function f(b){a.extend(a.data,b),h.notify({type:"data-update",data:b})}function g(b){"undefined"!=typeof b?(a.data[b]={},delete a.data[b]):(a.data={},delete a.data)}var h,i={id:"system-data"},j={"data-set":f,"data-clear":g};return{properties:i,initialize:b,destroy:c}}),CORE.createModule("system-localize",function(a){"use strict";function b(b){l=b.create(a,p.id),n=CORE.config[p.id],d(),o=n.default_language,g()}function c(){e(),l=null,m={}}function d(){l.listen(q)}function e(){l.ignore(Object.keys(q))}function f(a){o=a.language,g()}function g(){r[o]?h():$.getJSON(n.path+o+n.ext).done(function(a){r[o]=a,h()})}function h(){console.log("Language changed to "+o),l.notify({type:"data-set",data:{language:r[o]}}),i()}function i(){for(var a=document.querySelectorAll(".localize"),b=0;b<a.length;b++)j(a[b])}function j(a){var b=a.getAttribute("data-localize"),c=k(b);if(!c)return!1;switch(a.tagName){case"INPUT":a.value=c;break;default:a.innerHTML=c}}function k(b){return a.data.language[b]?a.data.language[b]:!1}var l,m,n,o,p={id:"system-localize"},q={"language-change":f},r={};return{properties:p,initialize:b,destroy:c}}),CORE.createModule("system-server",function(a){"use strict";function b(b){k=b.create(a,m.id),j=CORE.config[m.id],d()}function c(){e()}function d(){k.listen(n)}function e(){k.ignore(Object.keys(n))}function f(){}function g(b){a.log(1,["REQUEST",b]),l&&(b.session=l);var c={url:j.endpoint,data:JSON.stringify(b),type:"POST",dataType:"json",crossDomain:!0};return $.ajax(c).done(function(b){a.log(1,["RESPONSE",b]);for(var c in b)k.notify({type:c,data:b[c]})}).fail(function(){}).always(function(){})}function h(a){l=a}function i(){l=null}var j,k,l,m={id:"system-server"},n={"server-request":f,"server-post":g,"session-set":h,"session-clear":i};return{properties:m,initialize:b,destroy:c}});